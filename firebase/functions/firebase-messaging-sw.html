<html>
<body>


<div id = "token"></div>
<script src="https://www.gstatic.com/firebasejs/7.23.0/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.23.0/firebase-messaging.js"></script>



<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var config = {
    apiKey: "AIzaSyB_jkxL1W76KmMju0FdH8gT_SscHblxC8o",
    authDomain: "humanitech-65d8d.firebaseapp.com",
    databaseURL: "https://humanitech-65d8d.firebaseio.com",
    projectId: "humanitech-65d8d",
    storageBucket: "humanitech-65d8d.appspot.com",
    messagingSenderId: "30014619295",
    appId: "1:30014619295:web:b8515e27dd4f8faa6b2caa",
    measurementId: "G-NCEC9Y34PW"
  };
  // Initialize Firebase
  firebase.initializeApp(config);

  // Retrieve firebase Messaging object
  const messaging = firebase.messaging();

  messaging.usePublicVapidKey('BM7QuFrWp1r5YZrxh8ZW-MN7BPVRS_x_--KXBtXIw1bPuVr5JNpIi6SvlziFPS5kaDeQRE2roOj66jpd74wnGfo'); // insert public key

  Message.requestPermission().then(function() {
      console.log("Notification permission granted");
  


// Get Instance ID token. Initially this makes a network call, once retrieved
// subsequent calls to getToken will return from cache.


// messaging.getToken().then((currentToken) => {
//     if (currentToken) {
//       sendTokenToServer(currentToken);
//       updateUIForPushEnabled(currentToken);
//     } else {
//       // Show permission request.
//       console.log('No Instance ID token available. Request permission to generate one.');
//       // Show permission UI.
//       updateUIForPushPermissionRequired();
//       setTokenSentToServer(false);
//     }
//   }).catch((err) => {
//     console.log('An error occurred while retrieving token. ', err);
//     showToken('Error retrieving Instance ID token. ', err);
//     setTokenSentToServer(false);
//   });

  messaging.getToken().then(function(currentToken) {
      //sendTokenToServer(currentToken);
      console.log(currentToken);
      document.getElementById('token').innerHTML = currentToken;
      //updateUIForPushEnabled(currentToken);
    }).catch(function(err)  {
      // Show permission request.
      console.log('An error occured while retrieving token.' , err);
      showToken('Error retrieving Instance ID token. ', err);
      // Show permission UI.
      setTokenSentToServer(false);
    }); 

  }).catch((err) => {
    console.log('Unable to get permission to notify ', err);
    
  });

  messaging.onMessage(function(payload) {
    var obj = JSON.parse(payload.data.notification);
    var notification = new Notification(obj.title, {
      icon: obj.icon,
      body: obj.body
    });
  });

</script>

</body>

</html>